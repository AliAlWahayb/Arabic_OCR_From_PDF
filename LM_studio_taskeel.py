# -*- coding: utf-8 -*-
import openai

# Set the base URL and API key for the OpenAI client
openai.api_base = "http://localhost:1234/v1"
openai.api_key = "not-needed"

# إنشاء كود التفاعل
system = """
حسناً. أريد فقط تصحيح الأخطاء الإملائية في النص العربي دون أي إضافات أو تحديثات أخرى بدون تغيير او تبديل اي كلمه.
"""

user_input = '''الفصل الأول الخطاب فى شهر يونيو عام ١٩٣٥ كانت عودتى من مزرعتي الكبيرة فى أمريكا الجنوبية لكي اقضي حوالي ستة شهور فى إنَّجلترا. كنت قد أمضيت وقتا طويلا من العمل الشاق المضني فى تلك المزرعة. لقد قاسينا كل ما كان الناس فى العالم كله يقاسونه من الإحباط فى ذلك الوقت. وكانت تواجهني أمور ومهام كثيرة ومتنوعة فى إمجلترا, بينما كانت زوجتي لا تزال موجودة بالمزرعة فى أمريكا الجنوبية لتدبير شثونها قد استطاعتها حتَّى أعود إليها. ولا حاجة بى إلى القول بأن أول اهتمام لى لدى عودتي إلى إنَّجلترا إنَّما كان يتعلق بأن أحظى بمقابلة صديقى العزيز هركيول بوارو. لقد أمكن لى العثور عليه مستقرا فى شقة مفروشة على أحدث نظام فى مدينة لندن. واتهمته على الفور واعترف لى بصحة الاتهام أنَّه قد اختار هذه الشقة فى ذلك المبنى بالذات نظرا لما يتسم به المبنى من طراز معمارى تتبدى فيه الأشكال الهندسية صارمة فى خطوطها ومواصفاتها الرياضية الحديثة إذ قال لى على الفور عندما صارحته بهذا الاتهام: (نعم يا صديقى, إنَّ هذه التكوينات الهندسية فى هذا المبنى قتاز بتناسق مبهج جدا, أليس كذلك يا صديقي؟) وقلت أنا له: (أعتقد أنَّه يوجد إصرار على التمسك بالشكل المربع فى هذا المبنى وفى كل زخارفه كما لو كان المبنى يعلن عن إمكانية أن الدجاج فى هذا المنزل سيبيض بيضات مربعة الشكل). وضحك بوارو من صميم قلبه وهو يقول: (أه أنت لا زلت تتذكر هذه المزحة, لا يا صديقي, لم يصل العلم حتَّى الآن إلى إخضاع الدجاج لكي ينصاع إلى التجاوب مع هذه الدعابة, ولا يزال الدجا يييض بيضا مختلف الأحجام, وليس فيه بيضة واحدة مربعة الشكل). وتفحصت صديقي العجوز بعين المحبة. كانت حالته الصحية جيدة بشكل مدهش كما لو لم يكن قد انقضى يوم واحد منذ رأيته آخر مرة. فقلت له: وأنت تبدو على ما يرام يا بوارو. لم يتقدم بك العمر قيد أنملة. وفى الحقيقة- لو كان ذلك مكنا- لقد قل عدد الشعيرات البيضاء فى رأسك). وصدرت الإشاعات المرحة من صوت بوارو وهو يقول لى: ( هل تقصد أن شعرك يتحول من اللون الأبيض إلى اللون الأسمر؟) فقال: ( بالضبط), فقلت له: و ولكن, وبكل تأكيد, هذا مستحيل من الناحية العلمية). فقال: ( كلا, على الإطلاق). فقلت: ( هذا شع خارق. إنَّه يبدو مضادا لطبيعة الأشياء). قال بوارو: و أنت لا تزال تفكر كالمعتاد يا هاستنجز. عقلك عقل جميل لا يرتاب فى شع ولا يسأل ولا يندهش ولا يعجب من أى شي. و يغير مضى الأعوام ذلك فى عقلك أبدا! أنت تدرك حقيقة من الحقائق, وتترسب هذه الحقيقة فى أعماقك ولا تتغير أبدا دون أن تلحظ ذلك أو تفطن إلى ضرورة التغيير مهما جدت ضرورات للتغييرا وأنت لا تفطن إلى ذلك أبدا!). ونظرت إليه فى حيرة. وبدون كلمة واحدة مشى بوارو داخلا إلى حجرة نومه, وعاد وفى يده'''


prompt = user_input + "\n" + "صحح كل الاغلاط الاملائية" 

# Create a chat completion
completion = openai.ChatCompletion.create(
    model="local-model",  # this field is currently unused
    temperature=0,
    messages=[
        {"role": "system", "content": system},
        {"role": "user", "content": prompt}
    ],
    
)

# Print the chatbot's response
# print(completion.choices[0].message.content)


# Write the chatbot's response to a file
with open(f'LM_test_taskeel.txt', 'w', encoding='utf-8') as file:
    file.write(completion.choices[0].message.content)
    print(f"LM_test_taskeel.txt created successfully")
